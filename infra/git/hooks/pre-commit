#!/usr/bin/env bash

# Pre-commit hook to check for sensitive keywords
# This hook prevents commits that contain certain keywords

source "$(dirname "${BASH_SOURCE[0]}")/../../../scripts/common.sh"

GIT_ROOT=$(git rev-parse --show-toplevel)
BLACKWORDS_FILE="$GIT_ROOT/infra/git/blackwords"

# Get list of files to be committed (staged files)
FILES=$(git diff --cached --name-only --diff-filter=ACM)

if ! check_files_for_keywords "${BLACKWORDS_FILE}" "$FILES"; then
    echo -e "${RED}Commit rejected!${NC}"
    echo "Please remove the sensitive keywords from your files before committing."
    exit 1
fi

echo "Proceeding with commit..."
exit 0
